<!DOCTYPE html>
<html class="wf-proximanova1-n7-active wf-active" lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>A Step by Step Backpropagation Example – Matt Mazur</title>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://mattmazur.com/xmlrpc.php">
<!--[if lt IE 9]>
<script src="https://s0.wp.com/wp-content/themes/pub/publish/js/html5.js" type="text/javascript"></script>
<![endif]-->

<script src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/beacon.js" async=""></script><script src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/widgets.js" id="twitter-wjs"></script><script async="" type="text/javascript" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/webfont.js"></script><script type="text/javascript">
  WebFontConfig = {"typekit":{"id":"ich1dxo"}};
  (function() {
    var wf = document.createElement('script');
    wf.src = 'https://s1.wp.com/wp-content/plugins/custom-fonts/js/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style id="jetpack-custom-fonts-css">.wf-active .site-title{font-family:"proxima-nova-1","proxima-nova-2",sans-serif;font-style:normal;font-weight:700}.wf-active th{font-weight:700;font-family:"proxima-nova-1","proxima-nova-2",sans-serif;font-style:normal}.wf-active .single .format-aside h1.entry-title, .wf-active .single .format-chat h1.entry-title, .wf-active .single .format-gallery h1.entry-title, .wf-active .single .format-image h1.entry-title, .wf-active .single .format-link h1.entry-title, .wf-active .single .format-quote h1.entry-title, .wf-active .single .format-status h1.entry-title{font-family:"proxima-nova-1","proxima-nova-2",sans-serif;font-style:normal;font-weight:700}.wf-active h1, .wf-active h2, .wf-active h3, .wf-active h4, .wf-active h5, .wf-active h6{font-weight:700;font-family:"proxima-nova-1","proxima-nova-2",sans-serif;font-style:normal}.wf-active h1{font-style:normal;font-weight:700}.wf-active h2{font-style:normal;font-weight:700}.wf-active h3{font-style:normal;font-weight:700}.wf-active h4, .wf-active h5, .wf-active h6{font-weight:700;font-style:normal}</style>
<script type="text/javascript" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/wp-emoji-release.js"></script><style type="text/css">.tk-proxima-nova{font-family:"proxima-nova-1","proxima-nova-2",sans-serif;}</style><style type="text/css">@font-face{font-family:proxima-nova-1;src:url(https://fonts.typekit.net/af/03034e/00000000000000003b9ad1b1/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:700;font-style:normal;}</style><link rel="stylesheet" type="text/css" id="gravatar-card-css" href="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/hovercard.css"><link rel="stylesheet" type="text/css" id="gravatar-card-services-css" href="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/services.css"><script src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/timeline.js" async="" charset="utf-8" type="text/javascript"></script></head><body class="single single-post postid-3998 single-format-standard mp6 customizer-styles-applied highlander-enabled highlander-light"><input id="_wpnonce" name="_wpnonce" value="e2eb7996e4" type="hidden"><input name="_wp_http_referer" value="/2015/03/17/a-step-by-step-backpropagation-example/" type="hidden">		<script src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/remote-login.php" type="text/javascript"></script>
		<script type="text/javascript">
		/* <![CDATA[ */
			if ( 'function' === typeof WPRemoteLogin ) {
				document.cookie = "wordpress_test_cookie=test; path=/";
				if ( document.cookie.match( /(;|^)\s*wordpress_test_cookie\=/ ) ) {
					WPRemoteLogin();
				}
			}
		/* ]]> */
		</script>
		<link rel="dns-prefetch" href="https://s2.wp.com/">
<link rel="dns-prefetch" href="https://s1.wp.com/">
<link rel="dns-prefetch" href="https://s0.wp.com/">
<link rel="dns-prefetch" href="https://matthewmazur.wordpress.com/">
<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Matt Mazur » Feed" href="https://mattmazur.com/feed/">
<link rel="alternate" type="application/rss+xml" title="Matt Mazur » Comments Feed" href="https://mattmazur.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Matt Mazur » A Step by Step Backpropagation&nbsp;Example Comments Feed" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/feed/">
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1473172720h&ver=4.6.1-RC1-38499"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="all-css-0" href="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/a_002.css" type="text/css" media="all">
<script type="text/javascript" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/a_002"></script>
<link rel="stylesheet" id="all-css-0" href="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/style.css" type="text/css" media="all">
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='https://s1.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563h&#038;ver=20110606' type='text/css' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://matthewmazur.wordpress.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Introducing ABTestCalculator.com, an Open Source A/B Test Significance&nbsp;Calculator" href="https://mattmazur.com/2015/02/27/introducing-abtestcalculator-com-an-open-source-ab-test-significance-calculator/">
<link rel="next" title="TetriNET Bot Source Code Published on&nbsp;Github" href="https://mattmazur.com/2015/04/09/tetrinet-bot-source-code-published-on-github/">
<meta name="generator" content="WordPress.com">
<link rel="canonical" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/">
<link rel="shortlink" href="http://wp.me/p3COlO-12u">
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=json&amp;url=https%3A%2F%2Fmattmazur.com%2F2015%2F03%2F17%2Fa-step-by-step-backpropagation-example%2F&amp;for=wpcom-auto-discovery"><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=xml&amp;url=https%3A%2F%2Fmattmazur.com%2F2015%2F03%2F17%2Fa-step-by-step-backpropagation-example%2F&amp;for=wpcom-auto-discovery">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="A Step by Step Backpropagation Example">
<meta property="og:url" content="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/">
<meta property="og:description" content="Background Backpropagation is a common method for training a neural network. There is no shortage of papers online that attempt to explain how backpropagation works, but few that include an example…">
<meta property="article:published_time" content="2015-03-17T09:00:00+00:00">
<meta property="article:modified_time" content="2016-04-30T01:44:40+00:00">
<meta property="og:site_name" content="Matt Mazur">
<meta property="og:image" content="https://matthewmazur.files.wordpress.com/2018/03/output_1_backprop-4.png">
<meta property="og:image:width" content="649">
<meta property="og:image:height" content="318">
<meta property="og:locale" content="en_US">
<meta name="twitter:site" content="@mhmazur">
<meta name="twitter:image" content="https://matthewmazur.files.wordpress.com/2018/03/neural_network-7.png?w=240">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@mhmazur">
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom">
<link rel="shortcut icon" type="image/x-icon" href="https://s2.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48">
<link rel="icon" type="image/x-icon" href="https://s2.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48">
<link rel="apple-touch-icon-precomposed" href="https://s0.wp.com/i/webclip.png">
<link rel="openid.server" href="https://matthewmazur.wordpress.com/?openidserver=1">
<link rel="openid.delegate" href="https://matthewmazur.wordpress.com/">
<link rel="search" type="application/opensearchdescription+xml" href="https://mattmazur.com/osd.xml" title="Matt Mazur">
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com">
<meta name="application-name" content="Matt Mazur"><meta name="msapplication-window" content="width=device-width;height=device-height"><meta name="msapplication-task" content="name=Subscribe;action-uri=https://mattmazur.com/feed/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="title" content="A Step by Step Backpropagation&nbsp;Example | Matt Mazur on WordPress.com">
<meta name="description" content="Background Backpropagation is a common method for training a neural network. There is no shortage of papers online that attempt to explain how backpropagation works, but few that include an example with actual numbers. This post is my attempt to explain how it works with a concrete example that folks can compare their own calculations…">
<link rel="amphtml" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/amp/"><style type="text/css" id="syntaxhighlighteranchor"></style>
		<link rel="stylesheet" id="custom-css-css" type="text/css" href="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/a.css">
		


<div id="page" class="hfeed site">
	<header id="masthead" class="site-header" role="banner">
					<a class="site-logo" href="https://mattmazur.com/" title="Matt Mazur" rel="home">
				<img class="no-grav" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/a.png" alt="Matt Mazur" height="100" width="100">
			</a>
				<hgroup>
			<h1 class="site-title"><a href="https://mattmazur.com/" title="Matt Mazur" rel="home">Matt Mazur</a></h1>
			<h2 class="site-description"></h2>
		</hgroup>

		<nav role="navigation" class="site-navigation main-navigation">
			<h1 class="assistive-text">Menu</h1>
			<div class="assistive-text skip-link"><a href="#content" title="Skip to content">Skip to content</a></div>

			<div class="menu"><ul><li><a href="https://mattmazur.com/">Home</a></li><li class="page_item page-item-2"><a href="https://mattmazur.com/about/">About</a></li><li class="page_item page-item-2873"><a href="https://mattmazur.com/archives/">Archives</a></li><li class="page_item page-item-2793"><a href="https://mattmazur.com/contact/">Contact</a></li><li class="page_item page-item-7118"><a href="https://mattmazur.com/now/">Now</a></li><li class="page_item page-item-2779 page_item_has_children"><a href="https://mattmazur.com/projects/">Projects</a></li></ul></div>
		</nav><!-- .site-navigation .main-navigation -->

			</header><!-- #masthead .site-header -->

	<div id="main" class="site-main">

		<div id="primary" class="content-area">
			<div id="content" class="site-content" role="main">

			
				
<article id="post-3998" class="post-3998 post type-post status-publish format-standard hentry category-machine-learning tag-ai tag-backpropagation tag-machine-learning-2 tag-neural-networks">
	<header class="entry-header">
		<h1 class="entry-title">A Step by Step Backpropagation&nbsp;Example</h1>
	</header><!-- .entry-header -->

	<div class="entry-content">
		<h2>Background</h2>
<p>Backpropagation is a common method for training a neural network. There is <a href="https://www.google.com/search?q=backpropagation+algorithm">no shortage of papers</a>
 online that attempt to explain how backpropagation works, but few that 
include an example with actual numbers. This post is my attempt to 
explain how it works with a concrete example that folks can compare 
their own calculations to in order to ensure they understand 
backpropagation correctly.</p>
<p>If this kind of thing interests you, you should <a href="http://www.emergentmind.com/newsletter">sign up for my newsletter</a> where I post about AI-related projects that I’m working on.</p>
<h2>Backpropagation in Python</h2>
<p>You can play around with a Python script that I wrote that implements the backpropagation algorithm in <a href="https://github.com/mattm/simple-neural-network">this Github repo</a>.</p>
<h2>Backpropagation Visualization</h2>
<p>For an interactive&nbsp;visualization showing a neural network as it learns, check out my <a href="http://www.emergentmind.com/neural-network">Neural Network visualization</a>.</p>
<h2>Additional Resources</h2>
<p>If you find this tutorial useful and want to continue learning about 
neural networks and their applications, I highly recommend checking out 
Adrian Rosebrock’s excellent tutorial on <a href="http://www.pyimagesearch.com/2014/09/22/getting-started-deep-learning-python">Getting Started with Deep Learning and Python</a>.</p>
<h2>Overview</h2>
<p>For this tutorial, we’re going to use a neural network with two 
inputs, two hidden neurons, two output neurons. Additionally, the hidden
 and output neurons will include a bias.</p>
<p>Here’s the basic structure:</p>
<p><img class="alignnone size-full wp-image-4035 noborder" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/neural_network-7.png" alt="neural_network (7)"></p>
<p>In order to have some numbers to work with, here are the <span style="color:#ff0000;">initial weights</span>, <span style="color:#ff6600;">the biases</span>, and <span style="color:#0000ff;">training inputs/outputs</span>:</p>
<p><img class="alignnone size-full wp-image-4036 noborder" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/neural_network-9.png" alt="neural_network (9)"></p>
<p>The goal of backpropagation is to optimize the weights so that the 
neural network can learn how to correctly map arbitrary inputs to 
outputs.</p>
<p>For the rest of this tutorial we’re going to work with a single 
training set: given inputs 0.05 and 0.10, we want the neural network to 
output 0.01 and 0.99.</p>
<h2>The Forward Pass</h2>
<p>To begin, lets see what the neural network currently predicts given 
the weights and biases above and inputs of 0.05 and 0.10. To do this 
we’ll feed those inputs forward though the network.</p>
<p>We figure out the <em>total net input</em> to each hidden layer neuron, <em>squash</em> the total net input using an <em>activation function</em> (here we use the <em>logistic function</em>), then repeat the process with the output layer neurons.</p>
<div class="tip">Total net input is also referred to as just <i>net input</i> by <a href="http://web.cs.swarthmore.edu/%7Emeeden/cs81/s10/BackPropDeriv.pdf">some sources</a>.</div>
<p>Here’s how we calculate the total net input for <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_032.png" alt="h_1" title="h_1" class="latex">:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_048.png" alt="net_{h1} = w_1 * i_1 + w_2 * i_2 + b_1 * 1" title="net_{h1} = w_1 * i_1 + w_2 * i_2 + b_1 * 1" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_087.png" alt="net_{h1} = 0.15 * 0.05 + 0.2 * 0.1 + 0.35 * 1 = 0.3775" title="net_{h1} = 0.15 * 0.05 + 0.2 * 0.1 + 0.35 * 1 = 0.3775" class="latex"></p>
<p>We then squash it using the logistic function to get the output of <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_032.png" alt="h_1" title="h_1" class="latex">:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_007.png" alt="out_{h1} = \frac{1}{1+e^{-net_{h1}}} = \frac{1}{1+e^{-0.3775}} = 0.593269992" title="out_{h1} = \frac{1}{1+e^{-net_{h1}}} = \frac{1}{1+e^{-0.3775}} = 0.593269992" class="latex"></p>
<p>Carrying out the same process for <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_038.png" alt="h_2" title="h_2" class="latex"> we get:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex.png" alt="out_{h2} = 0.596884378" title="out_{h2} = 0.596884378" class="latex"></p>
<p>We repeat this process for the output layer neurons, using the output from the hidden layer neurons as inputs.</p>
<p>Here’s the output for <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_070.png" alt="o_1" title="o_1" class="latex">:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_009.png" alt="net_{o1} = w_5 * out_{h1} + w_6 * out_{h2} + b_2 * 1" title="net_{o1} = w_5 * out_{h1} + w_6 * out_{h2} + b_2 * 1" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_041.png" alt="net_{o1} = 0.4 * 0.593269992 + 0.45 * 0.596884378 + 0.6 * 1 = 1.105905967" title="net_{o1} = 0.4 * 0.593269992 + 0.45 * 0.596884378 + 0.6 * 1 = 1.105905967" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_034.png" alt="out_{o1} = \frac{1}{1+e^{-net_{o1}}} = \frac{1}{1+e^{-1.105905967}} = 0.75136507" title="out_{o1} = \frac{1}{1+e^{-net_{o1}}} = \frac{1}{1+e^{-1.105905967}} = 0.75136507" class="latex"></p>
<p>And carrying out the same process for <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_024.png" alt="o_2" title="o_2" class="latex"> we get:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_053.png" alt="out_{o2} = 0.772928465" title="out_{o2} = 0.772928465" class="latex"></p>
<h3>Calculating the Total Error</h3>
<p>We can now calculate the error for each output neuron using the <a href="http://en.wikipedia.org/wiki/Backpropagation#Derivation">squared error function</a> and sum them to get the total error:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_074.png" alt="E_{total} = \sum \frac{1}{2}(target - output)^{2}" title="E_{total} = \sum \frac{1}{2}(target - output)^{2}" class="latex"></p>
<div class="tip"><a href="http://www.amazon.com/Introduction-Math-Neural-Networks-Heaton-ebook/dp/B00845UQL6/ref=sr_1_1?ie=UTF8&amp;qid=1426296804&amp;sr=8-1&amp;keywords=neural+network">Some sources</a> refer to the target as the <i>ideal</i> and the output as the <i>actual</i>.</div>
<div class="tip">The <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_012.png" alt="\frac{1}{2}" title="\frac{1}{2}" class="latex">
 is included so that exponent is cancelled when we differentiate later 
on. The result is eventually multiplied by a learning rate anyway so it 
doesn’t matter that we introduce a constant here [<a href="http://en.wikipedia.org/wiki/Backpropagation#Derivation">1</a>].</div>
<p>For example, the target output for <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_070.png" alt="o_1" title="o_1" class="latex"> is 0.01 but the neural network output 0.75136507, therefore its error is:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_069.png" alt="E_{o1} = \frac{1}{2}(target_{o1} - out_{o1})^{2} = \frac{1}{2}(0.01 - 0.75136507)^{2} = 0.274811083" title="E_{o1} = \frac{1}{2}(target_{o1} - out_{o1})^{2} = \frac{1}{2}(0.01 - 0.75136507)^{2} = 0.274811083" class="latex"></p>
<p>Repeating this process for <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_024.png" alt="o_2" title="o_2" class="latex"> (remembering that the target is 0.99) we get:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_052.png" alt="E_{o2} = 0.023560026" title="E_{o2} = 0.023560026" class="latex"></p>
<p>The total error for the neural network is the sum of these errors:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_029.png" alt="E_{total} = E_{o1} + E_{o2} = 0.274811083 + 0.023560026 = 0.298371109" title="E_{total} = E_{o1} + E_{o2} = 0.274811083 + 0.023560026 = 0.298371109" class="latex"></p>
<h2>The Backwards Pass</h2>
<p>Our goal with backpropagation is to update each of the weights in the
 network so that they cause the actual output to be closer the target 
output, thereby minimizing the error for each output neuron and the 
network as a whole.</p>
<h3>Output Layer</h3>
<p>Consider <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_049.png" alt="w_5" title="w_5" class="latex">. We want to know how much a change in <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_049.png" alt="w_5" title="w_5" class="latex"> affects the total error, aka <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_072.png" alt="\frac{\partial E_{total}}{\partial w_{5}}" title="\frac{\partial E_{total}}{\partial w_{5}}" class="latex">.</p>
<div class="tip"><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_081.png" alt="\frac{\partial E_{total}}{\partial w_{5}}" title="\frac{\partial E_{total}}{\partial w_{5}}" class="latex"> is read as “the partial derivative of <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_023.png" alt="E_{total}" title="E_{total}" class="latex"> with respect to <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_037.png" alt="w_{5}" title="w_{5}" class="latex">“. You can also say “the gradient with respect to <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_037.png" alt="w_{5}" title="w_{5}" class="latex">“.</div>
<p>By applying the <a href="http://en.wikipedia.org/wiki/Chain_rule">chain rule</a> we know that:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_063.png" alt="\frac{\partial E_{total}}{\partial w_{5}} = \frac{\partial E_{total}}{\partial out_{o1}} * \frac{\partial out_{o1}}{\partial net_{o1}} * \frac{\partial net_{o1}}{\partial w_{5}}" title="\frac{\partial E_{total}}{\partial w_{5}} = \frac{\partial E_{total}}{\partial out_{o1}} * \frac{\partial out_{o1}}{\partial net_{o1}} * \frac{\partial net_{o1}}{\partial w_{5}}" class="latex"></p>
<p>Visually, here’s what we’re doing:</p>
<p><img class="alignnone size-full wp-image-4133 noborder" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/output_1_backprop-4.png" alt="output_1_backprop (4)"></p>
<p>We need to figure out each piece in this equation.</p>
<p>First, how much does the total error change with respect to the output?</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_066.png" alt="E_{total} = \frac{1}{2}(target_{o1} - out_{o1})^{2} + \frac{1}{2}(target_{o2} - out_{o2})^{2}" title="E_{total} = \frac{1}{2}(target_{o1} - out_{o1})^{2} + \frac{1}{2}(target_{o2} - out_{o2})^{2}" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_028.png" alt="\frac{\partial E_{total}}{\partial out_{o1}} = 2 * \frac{1}{2}(target_{o1} - out_{o1})^{2 - 1} * -1 + 0" title="\frac{\partial E_{total}}{\partial out_{o1}} = 2 * \frac{1}{2}(target_{o1} - out_{o1})^{2 - 1} * -1 + 0" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_082.png" alt="\frac{\partial E_{total}}{\partial out_{o1}} = -(target_{o1} - out_{o1}) = -(0.01 - 0.75136507) = 0.74136507" title="\frac{\partial E_{total}}{\partial out_{o1}} = -(target_{o1} - out_{o1}) = -(0.01 - 0.75136507) = 0.74136507" class="latex"></p>
<div class="tip"><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_040.png" alt="-(target - out)" title="-(target - out)" class="latex"> is sometimes expressed as <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_022.png" alt="out - target" title="out - target" class="latex"></div>
<div class="tip">When we take the partial derivative of the total error with respect to <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_083.png" alt="out_{o1}" title="out_{o1}" class="latex">, the quantity <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_062.png" alt="\frac{1}{2}(target_{o2} - out_{o2})^{2}" title="\frac{1}{2}(target_{o2} - out_{o2})^{2}" class="latex"> becomes zero because <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_083.png" alt="out_{o1}" title="out_{o1}" class="latex"> does not affect it which means we’re taking the derivative of a constant which is zero.</div>
<p>Next, how much does the output of <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_070.png" alt="o_1" title="o_1" class="latex"> change with respect to its total net input?</p>
<p>The partial <a href="http://en.wikipedia.org/wiki/Logistic_function#Derivative">derivative of the logistic function</a> is the output multiplied by 1 minus the output:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_064.png" alt="out_{o1} = \frac{1}{1+e^{-net_{o1}}}" title="out_{o1} = \frac{1}{1+e^{-net_{o1}}}" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_073.png" alt="\frac{\partial out_{o1}}{\partial net_{o1}} = out_{o1}(1 - out_{o1}) = 0.75136507(1 - 0.75136507) = 0.186815602" title="\frac{\partial out_{o1}}{\partial net_{o1}} = out_{o1}(1 - out_{o1}) = 0.75136507(1 - 0.75136507) = 0.186815602" class="latex"></p>
<p>Finally, how much does the total net input of <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_075.png" alt="o1" title="o1" class="latex"> change with respect to <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_049.png" alt="w_5" title="w_5" class="latex">?</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_009.png" alt="net_{o1} = w_5 * out_{h1} + w_6 * out_{h2} + b_2 * 1" title="net_{o1} = w_5 * out_{h1} + w_6 * out_{h2} + b_2 * 1" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_067.png" alt="\frac{\partial net_{o1}}{\partial w_{5}} = 1 * out_{h1} * w_5^{(1 - 1)} + 0 + 0 = out_{h1} = 0.593269992" title="\frac{\partial net_{o1}}{\partial w_{5}} = 1 * out_{h1} * w_5^{(1 - 1)} + 0 + 0 = out_{h1} = 0.593269992" class="latex"></p>
<p>Putting it all together:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_089.png" alt="\frac{\partial E_{total}}{\partial w_{5}} = \frac{\partial E_{total}}{\partial out_{o1}} * \frac{\partial out_{o1}}{\partial net_{o1}} * \frac{\partial net_{o1}}{\partial w_{5}}" title="\frac{\partial E_{total}}{\partial w_{5}} = \frac{\partial E_{total}}{\partial out_{o1}} * \frac{\partial out_{o1}}{\partial net_{o1}} * \frac{\partial net_{o1}}{\partial w_{5}}" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_031.png" alt="\frac{\partial E_{total}}{\partial w_{5}} = 0.74136507 * 0.186815602 * 0.593269992 = 0.082167041" title="\frac{\partial E_{total}}{\partial w_{5}} = 0.74136507 * 0.186815602 * 0.593269992 = 0.082167041" class="latex"></p>
<div class="tip">
<p>You’ll often see this calculation combined in the form of the <a href="http://en.wikipedia.org/wiki/Delta_rule">delta rule</a>:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_015.png" alt="\frac{\partial E_{total}}{\partial w_{5}} = -(target_{o1} - out_{o1}) * out_{o1}(1 - out_{o1}) * out_{h1}" title="\frac{\partial E_{total}}{\partial w_{5}} = -(target_{o1} - out_{o1}) * out_{o1}(1 - out_{o1}) * out_{h1}" class="latex"></p>
<p>Alternatively, we have <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_080.png" alt="\frac{\partial E_{total}}{\partial out_{o1}}" title="\frac{\partial E_{total}}{\partial out_{o1}}" class="latex"> and <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_076.png" alt="\frac{\partial out_{o1}}{\partial net_{o1}}" title="\frac{\partial out_{o1}}{\partial net_{o1}}" class="latex"> which can be written as <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_019.png" alt="\frac{\partial E_{total}}{\partial net_{o1}}" title="\frac{\partial E_{total}}{\partial net_{o1}}" class="latex">, aka <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_033.png" alt="\delta_{o1}" title="\delta_{o1}" class="latex"> (the Greek letter delta) aka the <i>node delta</i>. We can use this to rewrite the calculation above:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_014.png" alt="\delta_{o1} = \frac{\partial E_{total}}{\partial out_{o1}} * \frac{\partial out_{o1}}{\partial net_{o1}} = \frac{\partial E_{total}}{\partial net_{o1}}" title="\delta_{o1} = \frac{\partial E_{total}}{\partial out_{o1}} * \frac{\partial out_{o1}}{\partial net_{o1}} = \frac{\partial E_{total}}{\partial net_{o1}}" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_011.png" alt="\delta_{o1} = -(target_{o1} - out_{o1}) * out_{o1}(1 - out_{o1})" title="\delta_{o1} = -(target_{o1} - out_{o1}) * out_{o1}(1 - out_{o1})" class="latex"></p>
<p>Therefore:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_027.png" alt="\frac{\partial E_{total}}{\partial w_{5}} = \delta_{o1} out_{h1}" title="\frac{\partial E_{total}}{\partial w_{5}} = \delta_{o1} out_{h1}" class="latex"></p>
<p>Some sources extract the negative sign from <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_017.png" alt="\delta" title="\delta" class="latex"> so it would be written as:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_008.png" alt="\frac{\partial E_{total}}{\partial w_{5}} = -\delta_{o1} out_{h1}" title="\frac{\partial E_{total}}{\partial w_{5}} = -\delta_{o1} out_{h1}" class="latex"></p>
</div>
<p>To decrease the error, we then subtract this value from the current 
weight (optionally multiplied by some learning rate, eta, which we’ll 
set to 0.5):</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_078.png" alt="w_5^{+} = w_5 - \eta * \frac{\partial E_{total}}{\partial w_{5}} = 0.4 - 0.5 * 0.082167041 = 0.35891648" title="w_5^{+} = w_5 - \eta * \frac{\partial E_{total}}{\partial w_{5}} = 0.4 - 0.5 * 0.082167041 = 0.35891648" class="latex"></p>
<div class="tip"><a href="http://en.wikipedia.org/wiki/Delta_rule">Some</a> <a href="http://aima.cs.berkeley.edu/">sources</a> use <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_002.png" alt="\alpha" title="\alpha" class="latex"> (alpha) to represent the learning rate, <a href="https://www4.rgu.ac.uk/files/chapter3%20-%20bp.pdf">others use</a> <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_018.png" alt="\eta" title="\eta" class="latex"> (eta), and <a href="http://web.cs.swarthmore.edu/%7Emeeden/cs81/s10/BackPropDeriv.pdf">others</a> even use <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_086.png" alt="\epsilon" title="\epsilon" class="latex"> (epsilon).</div>
<p>We can repeat this process to get the new weights <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_026.png" alt="w_6" title="w_6" class="latex">, <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_020.png" alt="w_7" title="w_7" class="latex">, and <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_021.png" alt="w_8" title="w_8" class="latex">:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_050.png" alt="w_6^{+} = 0.408666186" title="w_6^{+} = 0.408666186" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_056.png" alt="w_7^{+} = 0.511301270" title="w_7^{+} = 0.511301270" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_077.png" alt="w_8^{+} = 0.561370121" title="w_8^{+} = 0.561370121" class="latex"></p>
<p>We perform the actual updates in the neural network <i>after</i> we 
have the new weights leading into the hidden layer neurons (ie, we use 
the original weights, not the updated weights, when we continue the 
backpropagation algorithm below).</p>
<h3>Hidden Layer</h3>
<p>Next, we’ll continue the backwards pass by calculating new values for <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_084.png" alt="w_1" title="w_1" class="latex">, <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_046.png" alt="w_2" title="w_2" class="latex">, <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_016.png" alt="w_3" title="w_3" class="latex">, and <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_060.png" alt="w_4" title="w_4" class="latex">.</p>
<p>Big picture, here’s what we need to figure out:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_061.png" alt="\frac{\partial E_{total}}{\partial w_{1}} = \frac{\partial E_{total}}{\partial out_{h1}} * \frac{\partial out_{h1}}{\partial net_{h1}} * \frac{\partial net_{h1}}{\partial w_{1}}" title="\frac{\partial E_{total}}{\partial w_{1}} = \frac{\partial E_{total}}{\partial out_{h1}} * \frac{\partial out_{h1}}{\partial net_{h1}} * \frac{\partial net_{h1}}{\partial w_{1}}" class="latex"></p>
<p>Visually:</p>
<p><a href="https://matthewmazur.files.wordpress.com/2015/03/nn-calculation.png"><img class="alignnone size-full wp-image-4261" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/nn-calculation.png" alt="nn-calculation"></a></p>
<p>We’re going to use a similar process as we did for the output layer, 
but slightly different to account for the fact that the output of each 
hidden layer neuron contributes to the output (and therefore error) of 
multiple output neurons. We know that <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_039.png" alt="out_{h1}" title="out_{h1}" class="latex"> affects both <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_055.png" alt="out_{o1}" title="out_{o1}" class="latex"> and <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_025.png" alt="out_{o2}" title="out_{o2}" class="latex"> therefore the <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_065.png" alt="\frac{\partial E_{total}}{\partial out_{h1}}" title="\frac{\partial E_{total}}{\partial out_{h1}}" class="latex"> needs to take into consideration its effect on the both output neurons:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_068.png" alt="\frac{\partial E_{total}}{\partial out_{h1}} = \frac{\partial E_{o1}}{\partial out_{h1}} + \frac{\partial E_{o2}}{\partial out_{h1}}" title="\frac{\partial E_{total}}{\partial out_{h1}} = \frac{\partial E_{o1}}{\partial out_{h1}} + \frac{\partial E_{o2}}{\partial out_{h1}}" class="latex"></p>
<p>Starting with <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_010.png" alt="\frac{\partial E_{o1}}{\partial out_{h1}}" title="\frac{\partial E_{o1}}{\partial out_{h1}}" class="latex">:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_079.png" alt="\frac{\partial E_{o1}}{\partial out_{h1}} = \frac{\partial E_{o1}}{\partial net_{o1}} * \frac{\partial net_{o1}}{\partial out_{h1}}" title="\frac{\partial E_{o1}}{\partial out_{h1}} = \frac{\partial E_{o1}}{\partial net_{o1}} * \frac{\partial net_{o1}}{\partial out_{h1}}" class="latex"></p>
<p>We can calculate <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_044.png" alt="\frac{\partial E_{o1}}{\partial net_{o1}}" title="\frac{\partial E_{o1}}{\partial net_{o1}}" class="latex"> using values we calculated earlier:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_035.png" alt="\frac{\partial E_{o1}}{\partial net_{o1}} = \frac{\partial E_{o1}}{\partial out_{o1}} * \frac{\partial out_{o1}}{\partial net_{o1}} = 0.74136507 * 0.186815602 = 0.138498562" title="\frac{\partial E_{o1}}{\partial net_{o1}} = \frac{\partial E_{o1}}{\partial out_{o1}} * \frac{\partial out_{o1}}{\partial net_{o1}} = 0.74136507 * 0.186815602 = 0.138498562" class="latex"></p>
<p>And <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_051.png" alt="\frac{\partial net_{o1}}{\partial out_{h1}}" title="\frac{\partial net_{o1}}{\partial out_{h1}}" class="latex"> is equal to <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_049.png" alt="w_5" title="w_5" class="latex">:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_009.png" alt="net_{o1} = w_5 * out_{h1} + w_6 * out_{h2} + b_2 * 1" title="net_{o1} = w_5 * out_{h1} + w_6 * out_{h2} + b_2 * 1" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_088.png" alt="\frac{\partial net_{o1}}{\partial out_{h1}} = w_5 = 0.40" title="\frac{\partial net_{o1}}{\partial out_{h1}} = w_5 = 0.40" class="latex"></p>
<p>Plugging them in:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_057.png" alt="\frac{\partial E_{o1}}{\partial out_{h1}} = \frac{\partial E_{o1}}{\partial net_{o1}} * \frac{\partial net_{o1}}{\partial out_{h1}} = 0.138498562 * 0.40 = 0.055399425" title="\frac{\partial E_{o1}}{\partial out_{h1}} = \frac{\partial E_{o1}}{\partial net_{o1}} * \frac{\partial net_{o1}}{\partial out_{h1}} = 0.138498562 * 0.40 = 0.055399425" class="latex"></p>
<p>Following the same process for <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_059.png" alt="\frac{\partial E_{o2}}{\partial out_{o1}}" title="\frac{\partial E_{o2}}{\partial out_{o1}}" class="latex">, we get:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_045.png" alt="\frac{\partial E_{o2}}{\partial out_{h1}} = -0.019049119" title="\frac{\partial E_{o2}}{\partial out_{h1}} = -0.019049119" class="latex"></p>
<p>Therefore:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_054.png" alt="\frac{\partial E_{total}}{\partial out_{h1}} = \frac{\partial E_{o1}}{\partial out_{h1}} + \frac{\partial E_{o2}}{\partial out_{h1}} = 0.055399425 + -0.019049119 = 0.036350306" title="\frac{\partial E_{total}}{\partial out_{h1}} = \frac{\partial E_{o1}}{\partial out_{h1}} + \frac{\partial E_{o2}}{\partial out_{h1}} = 0.055399425 + -0.019049119 = 0.036350306" class="latex"></p>
<p>Now that we have <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_065.png" alt="\frac{\partial E_{total}}{\partial out_{h1}}" title="\frac{\partial E_{total}}{\partial out_{h1}}" class="latex">, we need to figure out <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_030.png" alt="\frac{\partial out_{h1}}{\partial net_{h1}}" title="\frac{\partial out_{h1}}{\partial net_{h1}}" class="latex"> and then <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_047.png" alt="\frac{\partial net_{h1}}{\partial w}" title="\frac{\partial net_{h1}}{\partial w}" class="latex"> for each weight:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_058.png" alt="out_{h1} = \frac{1}{1+e^{-net_{h1}}}" title="out_{h1} = \frac{1}{1+e^{-net_{h1}}}" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_013.png" alt="\frac{\partial out_{h1}}{\partial net_{h1}} = out_{h1}(1 - out_{h1}) = 0.59326999(1 - 0.59326999 ) = 0.241300709" title="\frac{\partial out_{h1}}{\partial net_{h1}} = out_{h1}(1 - out_{h1}) = 0.59326999(1 - 0.59326999 ) = 0.241300709" class="latex"></p>
<p>We calculate the partial derivative of the total net input to <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_032.png" alt="h_1" title="h_1" class="latex"> with respect to <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_084.png" alt="w_1" title="w_1" class="latex"> the same as we did for the output neuron:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_048.png" alt="net_{h1} = w_1 * i_1 + w_2 * i_2 + b_1 * 1" title="net_{h1} = w_1 * i_1 + w_2 * i_2 + b_1 * 1" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_004.png" alt="\frac{\partial net_{h1}}{\partial w_1} = i_1 = 0.05" title="\frac{\partial net_{h1}}{\partial w_1} = i_1 = 0.05" class="latex"></p>
<p>Putting it all together:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_061.png" alt="\frac{\partial E_{total}}{\partial w_{1}} = \frac{\partial E_{total}}{\partial out_{h1}} * \frac{\partial out_{h1}}{\partial net_{h1}} * \frac{\partial net_{h1}}{\partial w_{1}}" title="\frac{\partial E_{total}}{\partial w_{1}} = \frac{\partial E_{total}}{\partial out_{h1}} * \frac{\partial out_{h1}}{\partial net_{h1}} * \frac{\partial net_{h1}}{\partial w_{1}}" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_003.png" alt="\frac{\partial E_{total}}{\partial w_{1}} = 0.036350306 * 0.241300709 * 0.05 = 0.000438568" title="\frac{\partial E_{total}}{\partial w_{1}} = 0.036350306 * 0.241300709 * 0.05 = 0.000438568" class="latex"></p>
<div class="tip">
<p>You might also see this written as:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_071.png" alt="\frac{\partial E_{total}}{\partial w_{1}} = (\sum\limits_{o}{\frac{\partial E_{total}}{\partial out_{o}} * \frac{\partial out_{o}}{\partial net_{o}} * \frac{\partial net_{o}}{\partial out_{h1}}}) * \frac{\partial out_{h1}}{\partial net_{h1}} * \frac{\partial net_{h1}}{\partial w_{1}}" title="\frac{\partial E_{total}}{\partial w_{1}} = (\sum\limits_{o}{\frac{\partial E_{total}}{\partial out_{o}} * \frac{\partial out_{o}}{\partial net_{o}} * \frac{\partial net_{o}}{\partial out_{h1}}}) * \frac{\partial out_{h1}}{\partial net_{h1}} * \frac{\partial net_{h1}}{\partial w_{1}}" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_036.png" alt="\frac{\partial E_{total}}{\partial w_{1}} = (\sum\limits_{o}{\delta_{o} * w_{ho}}) * out_{h1}(1 - out_{h1}) * i_{1}" title="\frac{\partial E_{total}}{\partial w_{1}} = (\sum\limits_{o}{\delta_{o} * w_{ho}}) * out_{h1}(1 - out_{h1}) * i_{1}" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_085.png" alt="\frac{\partial E_{total}}{\partial w_{1}} = \delta_{h1}i_{1}" title="\frac{\partial E_{total}}{\partial w_{1}} = \delta_{h1}i_{1}" class="latex"></p>
</div>
<p>We can now update <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_084.png" alt="w_1" title="w_1" class="latex">:</p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_043.png" alt="w_1^{+} = w_1 - \eta * \frac{\partial E_{total}}{\partial w_{1}} = 0.15 - 0.5 * 0.000438568 = 0.149780716" title="w_1^{+} = w_1 - \eta * \frac{\partial E_{total}}{\partial w_{1}} = 0.15 - 0.5 * 0.000438568 = 0.149780716" class="latex"></p>
<p>Repeating this for <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_046.png" alt="w_2" title="w_2" class="latex">, <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_016.png" alt="w_3" title="w_3" class="latex">, and <img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_060.png" alt="w_4" title="w_4" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_006.png" alt="w_2^{+} = 0.19956143" title="w_2^{+} = 0.19956143" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_042.png" alt="w_3^{+} = 0.24975114" title="w_3^{+} = 0.24975114" class="latex"></p>
<p><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/latex_005.png" alt="w_4^{+} = 0.29950229" title="w_4^{+} = 0.29950229" class="latex"></p>
<p>Finally, we’ve updated all of our weights! When we fed forward the 
0.05 and 0.1 inputs originally, the error on the network was 
0.298371109. After this first round of backpropagation, the total error 
is now down to 0.291027924. It might not seem like much, but after 
repeating this process 10,000 times, for example, the error plummets to 
0.000035085. At this point, when we feed forward 0.05 and 0.1, the two 
outputs neurons generate 0.015912196 (vs 0.01 target) and 0.984065734 
(vs 0.99 target).</p>
<p>If you’ve made it this far and found any errors in any of the above 
or can think of any ways to make it clearer for future readers, don’t 
hesitate to <a href="https://mattmazur.com/contact/">drop me a note</a>. Thanks!</p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-3998" class="share-twitter sd-button share-icon" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-3998" class="share-facebook sd-button share-icon" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?share=facebook&amp;nb=1" target="_blank" title="Share on Facebook"><span>Facebook<span class="share-count">526</span></span></a></li><li class="share-end"></li></ul></div></div></div><div class="sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-loaded" id="like-post-wrapper-53579024-3998-57e1e015d3d98" data-src="//widgets.wp.com/likes/#blog_id=53579024&amp;post_id=3998&amp;origin=matthewmazur.wordpress.com&amp;obj_id=53579024-3998-57e1e015d3d98" data-name="like-post-frame-53579024-3998-57e1e015d3d98"><h3 class="sd-title">Like this:</h3><div class="likes-widget-placeholder post-likes-widget-placeholder" style="height: 55px; display: none;"><span class="button"><span>Like</span></span> <span class="loading">Loading...</span></div><iframe class="post-likes-widget jetpack-likes-widget" name="like-post-frame-53579024-3998-57e1e015d3d98" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/a.html" frameborder="0" height="55px" width="100%"></iframe><span class="sd-text-color"></span><a class="sd-link-color"></a></div>
<div style="display: block;" id="jp-relatedposts" class="jp-relatedposts">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
<div class="jp-relatedposts-items jp-relatedposts-items-minimal"><p class="jp-relatedposts-post jp-relatedposts-post0" data-post-id="5793" data-post-format="false"><span class="jp-relatedposts-post-title"><a data-position="0" data-origin="3998" rel="nofollow" title="The State of Emergent Mind

In 2014&nbsp;I worked on a side project called Emergent Mind&nbsp;to learn more about AI, artificial life and related topics. The result was 10 interactive JavaScript visualizations ranging from Boids to neural networks. I really enjoyed working on it and received&nbsp;a lot of great feedback, but I had to put it…" href="https://mattmazur.com/2015/12/11/the-state-of-emergent-mind/" class="jp-relatedposts-post-a">The State of Emergent Mind</a></span><span class="jp-relatedposts-post-context">In "Emergent Mind"</span></p><p class="jp-relatedposts-post jp-relatedposts-post1" data-post-id="1188" data-post-format="false"><span class="jp-relatedposts-post-title"><a data-position="1" data-origin="3998" rel="nofollow" title="Experimenting with a Neural Network-based Poker Bot

This is post #11 in an ongoing series of articles about my work as a poker bot developer.At one point or another most poker bot developers have an epiphany. Their eyes open wide and they excitedly shout to the next stranger they see: &quot;I'll do it with a neural network!&quot;…" href="https://mattmazur.com/2009/10/13/experimenting-with-a-neural-network-based-poker-bot/" class="jp-relatedposts-post-a">Experimenting with a Neural Network-based Poker Bot</a></span><span class="jp-relatedposts-post-context">In "Poker Bot"</span></p><p class="jp-relatedposts-post jp-relatedposts-post2" data-post-id="3888" data-post-format="false"><span class="jp-relatedposts-post-title"><a data-position="2" data-origin="3998" rel="nofollow" title="Emergent Mind #10

Check out my latest Emergent Mind project, Visualizing a Neural Network with Backpropagation. This one has been sitting mostly-finished on my computer for way too long so I'm happy to finally get it out there :)" href="https://mattmazur.com/2014/10/15/emergent-mind-10/" class="jp-relatedposts-post-a">Emergent Mind #10</a></span><span class="jp-relatedposts-post-context">In "Emergent Mind"</span></p></div></div></div>			</div><!-- .entry-content -->

	<footer class="entry-meta">
		Posted on <a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/" title="5:00 am" rel="bookmark"><time class="entry-date" datetime="2015-03-17T05:00:00+00:00" pubdate="">March 17, 2015</time></a><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://mattmazur.com/author/mhmazur/" title="View all posts by Mazur" rel="author">Mazur</a></span></span>.		This entry was posted in <a href="https://mattmazur.com/category/machine-learning/" rel="category tag">Machine Learning</a> and tagged <a href="https://mattmazur.com/tag/ai/" rel="tag">ai</a>, <a href="https://mattmazur.com/tag/backpropagation/" rel="tag">backpropagation</a>, <a href="https://mattmazur.com/tag/machine-learning-2/" rel="tag">machine learning</a>, <a href="https://mattmazur.com/tag/neural-networks/" rel="tag">neural networks</a>. Bookmark the <a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/" title="Permalink to A Step by Step Backpropagation&nbsp;Example" rel="bookmark">permalink</a>.
			</footer><!-- .entry-meta -->
</article><!-- #post-3998 -->

					<nav role="navigation" id="nav-below" class="site-navigation post-navigation">
		<h1 class="assistive-text">Post navigation</h1>

	
		<div class="nav-previous"><a href="https://mattmazur.com/2015/02/27/introducing-abtestcalculator-com-an-open-source-ab-test-significance-calculator/" rel="prev"><span class="meta-nav">←</span> Introducing ABTestCalculator.com, an Open Source A/B Test Significance&nbsp;Calculator</a></div>		<div class="nav-next"><a href="https://mattmazur.com/2015/04/09/tetrinet-bot-source-code-published-on-github/" rel="next">TetriNET Bot Source Code Published on&nbsp;Github <span class="meta-nav">→</span></a></div>
	
	</nav><!-- #nav-below -->
	
				
	<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			215 thoughts on “<span>A Step by Step Backpropagation&nbsp;Example</span>”		</h2>

				<nav role="navigation" id="comment-nav-above" class="site-navigation comment-navigation">
			<h1 class="assistive-text">Comment navigation</h1>
			<div class="nav-previous"><a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-3/#comments">← Older Comments</a></div>
			<div class="nav-next"></div>
		</nav><!-- #comment-nav-before .site-navigation .comment-navigation -->
		
		<ol class="commentlist">
			
	<li class="comment byuser comment-author-leafartz even thread-even depth-1 highlander-comment" id="li-comment-21477">
		<article id="comment-21477" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-fe7abe552d96bab4d98bccce357000eb-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/fe7abe552d96bab4d98bccce357000eb.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn"><a href="http://gravatar.com/leafartz" rel="external nofollow" class="url">leafartz</a></cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21477"><time pubdate="" datetime="2016-08-18T10:55:23+00:00">
					August 18, 2016 at 10:55 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>Thanks dude! finally, i could understand very well this issue.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21477#respond" onclick='return addComment.moveForm( "comment-21477", "21477", "respond", "3998" )' aria-label="Reply to leafartz">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-21478">
		<article id="comment-21478" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-aa9e67eb9772038419f79dea484681b7-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/aa9e67eb9772038419f79dea484681b7.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn">Ronald</cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21478"><time pubdate="" datetime="2016-08-18T13:12:35+00:00">
					August 18, 2016 at 1:12 pm					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>THANK’S I helped a lot<br>
Greetings from Peru</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21478#respond" onclick='return addComment.moveForm( "comment-21478", "21478", "respond", "3998" )' aria-label="Reply to Ronald">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->

	<li class="comment byuser comment-author-javamylanguage even thread-even depth-1 highlander-comment" id="li-comment-21480">
		<article id="comment-21480" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-61e4ab627bc6527062c35acc03db0e08-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/61e4ab627bc6527062c35acc03db0e08.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn"><a href="https://mayankrajoria.com/" rel="external nofollow" class="url">mayankr</a></cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21480"><time pubdate="" datetime="2016-08-19T08:20:54+00:00">
					August 19, 2016 at 8:20 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>Great explaination, Thanks!</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21480#respond" onclick='return addComment.moveForm( "comment-21480", "21480", "respond", "3998" )' aria-label="Reply to mayankr">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->

	<li class="comment byuser comment-author-javamylanguage odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-21481">
		<article id="comment-21481" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-61e4ab627bc6527062c35acc03db0e08-1" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/61e4ab627bc6527062c35acc03db0e08.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn"><a href="http://mayankrajoria.com/" rel="external nofollow" class="url">mayankr</a></cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21481"><time pubdate="" datetime="2016-08-19T08:25:50+00:00">
					August 19, 2016 at 8:25 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>Great post, clear concepts! Thanks!!</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21481#respond" onclick='return addComment.moveForm( "comment-21481", "21481", "respond", "3998" )' aria-label="Reply to mayankr">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1 highlander-comment" id="li-comment-21483">
		<article id="comment-21483" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/__mG6wPV_normal.jpg" class="avatar avatar-40" height="40" width="40">					<cite class="fn"><a href="http://twitter.com/baio1980" rel="external nofollow" class="url">max putilov (@baio1980)</a></cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21483"><time pubdate="" datetime="2016-08-19T15:23:27+00:00">
					August 19, 2016 at 3:23 pm					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>Helps a lot, thanks</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21483#respond" onclick='return addComment.moveForm( "comment-21483", "21483", "respond", "3998" )' aria-label="Reply to max putilov (@baio1980)">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-21489">
		<article id="comment-21489" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-387636b50647d7bdcea576d840a15592-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/387636b50647d7bdcea576d840a15592.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn">kanu</cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21489"><time pubdate="" datetime="2016-08-20T08:53:20+00:00">
					August 20, 2016 at 8:53 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>nice one</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21489#respond" onclick='return addComment.moveForm( "comment-21489", "21489", "respond", "3998" )' aria-label="Reply to kanu">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1 highlander-comment" id="li-comment-21491">
		<article id="comment-21491" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-4f2dc6d2646f91673908ef2ab379807d-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/4f2dc6d2646f91673908ef2ab379807d.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn">A P</cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21491"><time pubdate="" datetime="2016-08-20T14:41:54+00:00">
					August 20, 2016 at 2:41 pm					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>It was a revelation. Equations with many Greek letters does not explain much alone. Keep going!</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21491#respond" onclick='return addComment.moveForm( "comment-21491", "21491", "respond", "3998" )' aria-label="Reply to A P">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-21495">
		<article id="comment-21495" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-2a248780c935d35caf8f9bb0108393c6-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/2a248780c935d35caf8f9bb0108393c6.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn"><a href="http://twitter.com/baio1980" rel="external nofollow" class="url">max putilov (@baio1980)</a></cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21495"><time pubdate="" datetime="2016-08-21T06:58:32+00:00">
					August 21, 2016 at 6:58 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>Btw, why dont you calculate gradients for biases ?</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21495#respond" onclick='return addComment.moveForm( "comment-21495", "21495", "respond", "3998" )' aria-label="Reply to max putilov (@baio1980)">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	<ul class="children">

	<li class="comment byuser comment-author-mhmazur bypostauthor even depth-2 highlander-comment" id="li-comment-21501">
		<article id="comment-21501" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-36410bc698c05fe9cc30bca18d8e96ed-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/36410bc698c05fe9cc30bca18d8e96ed.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn"><a href="http://www.mattmazur.com/" rel="external nofollow" class="url">Mazur</a></cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21501"><time pubdate="" datetime="2016-08-22T09:34:30+00:00">
					August 22, 2016 at 9:34 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>Some guides do that, others don’t. I didn’t for this tutorial.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21501#respond" onclick='return addComment.moveForm( "comment-21501", "21501", "respond", "3998" )' aria-label="Reply to Mazur">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	<ul class="children">

	<li class="comment odd alt depth-3 highlander-comment" id="li-comment-21590">
		<article id="comment-21590" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-82d561dcb070b01aa3c94031315df2e1-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/82d561dcb070b01aa3c94031315df2e1.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn">Sjoerd Redeker</cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21590"><time pubdate="" datetime="2016-09-09T02:45:05+00:00">
					September 9, 2016 at 2:45 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>Is there a possibility you can show 
us how to calculate the gradients for the biases? Love this tutorial by 
the way it is very informative and clear!</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21590#respond" onclick='return addComment.moveForm( "comment-21590", "21590", "respond", "3998" )' aria-label="Reply to Sjoerd Redeker">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1 highlander-comment" id="li-comment-21542">
		<article id="comment-21542" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-14a5bbd95ed0c34b3bb11de5028d51f4-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/14a5bbd95ed0c34b3bb11de5028d51f4.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn">Sabyasachi Mohanty</cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21542"><time pubdate="" datetime="2016-08-30T13:51:46+00:00">
					August 30, 2016 at 1:51 pm					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>Can you please do a tutorial for back propagation in Elmann recurrent neural networks!!…. It would be of a lot of help…</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21542#respond" onclick='return addComment.moveForm( "comment-21542", "21542", "respond", "3998" )' aria-label="Reply to Sabyasachi Mohanty">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-21562">
		<article id="comment-21562" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-c1408838096c4eea77efe7b45ce038f8-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/c1408838096c4eea77efe7b45ce038f8.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn">Dion</cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21562"><time pubdate="" datetime="2016-09-04T08:59:39+00:00">
					September 4, 2016 at 8:59 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>Great article!  I struggle with one 
aspect though and that is calculating the partial derivatives from 
out/net, using (output * (1.0 – output).  In cases where output is 0 or 
1, it effectively kills the pass through of error.  How do you handle 
this when, especially at startup, the network can devolve (or even 
start) in this state?<br>
Thanks!</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21562#respond" onclick='return addComment.moveForm( "comment-21562", "21562", "respond", "3998" )' aria-label="Reply to Dion">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1 highlander-comment" id="li-comment-21572">
		<article id="comment-21572" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-e4ab10dc291c2e019f6dd283df747fef-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/e4ab10dc291c2e019f6dd283df747fef.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn">Ann</cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21572"><time pubdate="" datetime="2016-09-06T05:24:53+00:00">
					September 6, 2016 at 5:24 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>should be the first stop for anyone to understand backward propagation, very well explained…thanks a lot</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21572#respond" onclick='return addComment.moveForm( "comment-21572", "21572", "respond", "3998" )' aria-label="Reply to Ann">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-21574">
		<article id="comment-21574" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-a8984bc12b76444448bc40fd87daa194-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/a8984bc12b76444448bc40fd87daa194.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn">Reza</cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21574"><time pubdate="" datetime="2016-09-06T09:49:40+00:00">
					September 6, 2016 at 9:49 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>Very informative, Thank you</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21574#respond" onclick='return addComment.moveForm( "comment-21574", "21574", "respond", "3998" )' aria-label="Reply to Reza">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1 highlander-comment" id="li-comment-21585">
		<article id="comment-21585" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-55f28e9c77b35b1539af6be60986b0e4-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/55f28e9c77b35b1539af6be60986b0e4.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn"><a href="http://gravatar.com/philiprhoades" rel="external nofollow" class="url">Philip Rhoades</a></cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21585"><time pubdate="" datetime="2016-09-07T14:34:58+00:00">
					September 7, 2016 at 2:34 pm					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>In trying to understand NNs better I have produced a Google Docs spreadsheet that almost does what this link talks about:</p>
<p> <a href="https://jamesmccaffrey.files.wordpress.com/2012/11/backpropagationcalculations.jpg"><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/backpropagationcalculations.jpg" style="max-width:100%;"></a></p>
<p>I was hoping that going through that exercise will give me a better 
mental picture of what a NN is doing when it is working. I should be 
able to see easily by direct comparison what happens to the set of 
numbers with each iteration (ie each new pair of FP and BP sheets). I 
think I have got it nearly working except for the stuff in the dashed 
purple box. I want to confirm that the purple arrow is pointing to the 
wrong blue arrow?  I also want someone to tell me how to implement the 
purple box . .  If I could work that out I think I could then repeat the
 FR and BP sheets and see how the Diff column evolves . . here is the 
current SS:</p>
<p>  <a href="https://docs.google.com/spreadsheets/d/1-YxT_PuzDt3VXrOucOBHzxBpSiB5USiy2ULaqE75Wcg/pubhtml" rel="nofollow">https://docs.google.com/spreadsheets/d/1-YxT_PuzDt3VXrOucOBHzxBpSiB5USiy2ULaqE75Wcg/pubhtml</a></p>
<p>I still found your description above heavy going – could you help me 
finish my spreadsheet or turn your example into a spreadsheet?</p>
<p>Thanks,<br>
Phil.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21585#respond" onclick='return addComment.moveForm( "comment-21585", "21585", "respond", "3998" )' aria-label="Reply to Philip Rhoades">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->

	<li class="comment byuser comment-author-khagola odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-21610">
		<article id="comment-21610" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-097eeada97f29ce29a3a6ea79db39de0-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/097eeada97f29ce29a3a6ea79db39de0.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn"><a href="http://onlyobi.blogspot.com/" rel="external nofollow" class="url">Hari Prasad</a></cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21610"><time pubdate="" datetime="2016-09-12T04:51:58+00:00">
					September 12, 2016 at 4:51 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>This is how any teaching or learning has to happen! Great work buddy!</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21610#respond" onclick='return addComment.moveForm( "comment-21610", "21610", "respond", "3998" )' aria-label="Reply to Hari Prasad">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->

	<li class="comment even thread-even depth-1 highlander-comment" id="li-comment-21614">
		<article id="comment-21614" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-6160e41069e535b55caa8d7c6d41bb91-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/6160e41069e535b55caa8d7c6d41bb91.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn">rambo</cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21614"><time pubdate="" datetime="2016-09-12T18:22:01+00:00">
					September 12, 2016 at 6:22 pm					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>Many thanks. The best tutorial I have ever seen</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21614#respond" onclick='return addComment.moveForm( "comment-21614", "21614", "respond", "3998" )' aria-label="Reply to rambo">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-21619">
		<article id="comment-21619" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/picture.jpeg" class="avatar avatar-40" height="40" width="40">					<cite class="fn"><a href="https://www.facebook.com/app_scoped_user_id/10153673861855793/" rel="external nofollow" class="url">Erhard M. Dinhobl</a></cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21619"><time pubdate="" datetime="2016-09-13T07:30:14+00:00">
					September 13, 2016 at 7:30 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>It seems that the learningrate of 
“0.5”  in this example here is too high. because it diverges with the 
given values. Maybe 0.05?</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21619#respond" onclick='return addComment.moveForm( "comment-21619", "21619", "respond", "3998" )' aria-label="Reply to Erhard M. Dinhobl">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	<ul class="children">

	<li class="comment even depth-2 highlander-comment" id="li-comment-21621">
		<article id="comment-21621" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/picture_002.jpeg" class="avatar avatar-40" height="40" width="40">					<cite class="fn"><a href="https://www.facebook.com/app_scoped_user_id/10153673861855793/" rel="external nofollow" class="url">Erhard M. Dinhobl</a></cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21621"><time pubdate="" datetime="2016-09-13T10:39:27+00:00">
					September 13, 2016 at 10:39 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>sorry, forgot to set the energy variable in the neuron back to zero after training</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21621#respond" onclick='return addComment.moveForm( "comment-21621", "21621", "respond", "3998" )' aria-label="Reply to Erhard M. Dinhobl">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-21634">
		<article id="comment-21634" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-87fff166977c518f4a21ec46a787e947-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/87fff166977c518f4a21ec46a787e947.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn">Michael Prager</cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21634"><time pubdate="" datetime="2016-09-17T19:17:21+00:00">
					September 17, 2016 at 7:17 pm					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>I found this post very helpful but 
there is one thing that is confusing me. You apply the logistic function
 on the output nodes to compute out_o1 and out_o2 as the sigmoid 
function applied to the weighted sum of the hidden nodes. My question 
is, what if you are predicting an output that has a range wider than 0 
to 1. I had thought the output layer was simply a weighted sum of the 
outputs of the final hidden layer. In that case you could output a value
 in any range, but this seems very limiting.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21634#respond" onclick='return addComment.moveForm( "comment-21634", "21634", "respond", "3998" )' aria-label="Reply to Michael Prager">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	<ul class="children">

	<li class="comment byuser comment-author-mhmazur bypostauthor even depth-2 highlander-comment" id="li-comment-21635">
		<article id="comment-21635" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-36410bc698c05fe9cc30bca18d8e96ed-1" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/36410bc698c05fe9cc30bca18d8e96ed.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn"><a href="http://www.mattmazur.com/" rel="external nofollow" class="url">Mazur</a></cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21635"><time pubdate="" datetime="2016-09-18T10:39:37+00:00">
					September 18, 2016 at 10:39 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>Yeah, this only works on a range of 0
 to 1. If you have a range from say 0 to 100 you can divide by 100 to 
get it down to a range of 0 to 1 so that you can use this neural 
network.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21635#respond" onclick='return addComment.moveForm( "comment-21635", "21635", "respond", "3998" )' aria-label="Reply to Mazur">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-21638">
		<article id="comment-21638" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-967d3a81b0cad6ebbff601f9ce9cf23b-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/967d3a81b0cad6ebbff601f9ce9cf23b.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn"><a href="http://gravatar.com/gsaldanha2" rel="external nofollow" class="url">Gregory</a></cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21638"><time pubdate="" datetime="2016-09-20T02:20:24+00:00">
					September 20, 2016 at 2:20 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>what does the Who mean in the expression for the hidden layers?<br>
The “ho” is small</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21638#respond" onclick='return addComment.moveForm( "comment-21638", "21638", "respond", "3998" )' aria-label="Reply to Gregory">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	<ul class="children">

	<li class="comment byuser comment-author-mhmazur bypostauthor even depth-2 highlander-comment" id="li-comment-21646">
		<article id="comment-21646" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-36410bc698c05fe9cc30bca18d8e96ed-2" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/36410bc698c05fe9cc30bca18d8e96ed.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn"><a href="http://www.mattmazur.com/" rel="external nofollow" class="url">Mazur</a></cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21646"><time pubdate="" datetime="2016-09-20T20:19:51+00:00">
					September 20, 2016 at 8:19 pm					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>Weight of the hidden output.</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21646#respond" onclick='return addComment.moveForm( "comment-21646", "21646", "respond", "3998" )' aria-label="Reply to Mazur">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-21639">
		<article id="comment-21639" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-05576b294d1bbd0345a48c2a884d465a-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/05576b294d1bbd0345a48c2a884d465a.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn">Anirban</cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21639"><time pubdate="" datetime="2016-09-20T03:27:30+00:00">
					September 20, 2016 at 3:27 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>You have used a squared error 
function. When using that as a cost function along with the sigmoid 
function, won’t your cost function have a lot of local minima ?</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21639#respond" onclick='return addComment.moveForm( "comment-21639", "21639", "respond", "3998" )' aria-label="Reply to Anirban">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->

	<li class="comment even thread-odd thread-alt depth-1 highlander-comment" id="li-comment-21640">
		<article id="comment-21640" class="comment">
			<footer>
				<div class="comment-author vcard">
					<img id="grav-062d40380f36be661511bedca6e3f0bb-0" alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/062d40380f36be661511bedca6e3f0bb.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">					<cite class="fn"><a href="https://ma.linkedin.com/in/dr-hajji-hicham-6601606" rel="external nofollow" class="url">Hajji Hicham</a></cite> <span class="says">says:</span>				</div><!-- .comment-author .vcard -->
				
				<div class="comment-meta commentmetadata">
					<a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-4/#comment-21640"><time pubdate="" datetime="2016-09-20T06:55:58+00:00">
					September 20, 2016 at 6:55 am					</time></a>
									</div><!-- .comment-meta .commentmetadata -->
			</footer>

			<div class="comment-content"><p>Thanks, it’s the best and clear step by step tutorial of the backpropagation alg I have ever read</p>
</div>

			<div class="reply">
				<a rel="nofollow" class="comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/?replytocom=21640#respond" onclick='return addComment.moveForm( "comment-21640", "21640", "respond", "3998" )' aria-label="Reply to Hajji Hicham">Reply</a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li><!-- #comment-## -->
		</ol><!-- .commentlist -->

				<nav role="navigation" id="comment-nav-below" class="site-navigation comment-navigation">
			<h1 class="assistive-text">Comment navigation</h1>
			<div class="nav-previous"><a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/comment-page-3/#comments">← Older Comments</a></div>
			<div class="nav-next"></div>
		</nav><!-- #comment-nav-below .site-navigation .comment-navigation -->
		
	
	
					<div id="respond" class="comment-respond js">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="https://mattmazur.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<input id="highlander_comment_nonce" name="highlander_comment_nonce" value="32fd68eab4" type="hidden"><input name="_wp_http_referer" value="/2015/03/17/a-step-by-step-backpropagation-example/" type="hidden">
<input name="hc_post_as" id="hc_post_as" value="guest" type="hidden">

<div class="comment-form-field comment-textarea">
	
	<div id="comment-form-comment"><textarea class="autosizejs " tabindex="-1" style="position: absolute; top: -999px; left: 0px; right: auto; bottom: auto; border: 0px none; padding: 0px; box-sizing: content-box; word-wrap: break-word; height: 0px ! important; min-height: 0px ! important; overflow: hidden; transition: none 0s ease 0s ; font-family: Arial,Helvetica,Tahoma,Verdana,sans-serif; font-size: 14px; font-weight: 300; font-style: normal; letter-spacing: 0px; text-transform: none; text-decoration: none; word-spacing: 0px; text-indent: 0px; line-height: 21px; width: 503px;">Enter your comment here...</textarea><textarea style="height: 41px; overflow: hidden; word-wrap: break-word; resize: none;" placeholder="Enter your comment here..." id="comment" name="comment" title="Enter your comment here..."></textarea></div>
</div>

<div style="display: none;" id="comment-form-identity">

	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li class="selected" style="display:none;">
				<a href="#comment-form-guest" id="postas-guest" title="Guest">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:WordPress.com" id="postas-wordpress" title="WordPress.com">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Twitter" id="postas-twitter" title="Twitter">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Facebook" id="postas-facebook" title="Facebook">
					<span></span>
				</a>
			</li>
			<li>
		</li></ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/ad516503a11cd5ca435acc9bb6523536.png" alt="Gravatar" class="no-grav" width="25">
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email"></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name <span class="required">(required)</span></label>
					<div class="comment-form-input"><input id="author" name="author" type="text"></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="text"></div>
				</div>
			</div>
	
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/ad516503a11cd5ca435acc9bb6523536.png" alt="WordPress.com Logo" class="no-grav" width="25">
			</div>

				<div class="comment-form-fields">
				<input name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="" type="hidden">
				<input name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="" type="hidden">
				<input name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="" type="hidden">
				<p class="comment-form-posting-as pa-wordpress"><strong></strong> You are commenting using your WordPress.com account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout(%20'wordpress'%20);">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-twitter" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/ad516503a11cd5ca435acc9bb6523536.png" alt="Twitter picture" class="no-grav" width="25">
			</div>

				<div class="comment-form-fields">
				<input name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value="" type="hidden">
				<input name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value="" type="hidden">
				<input name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value="" type="hidden">
				<p class="comment-form-posting-as pa-twitter"><strong></strong> You are commenting using your Twitter account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout(%20'twitter'%20);">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/ad516503a11cd5ca435acc9bb6523536.png" alt="Facebook photo" class="no-grav" width="25">
			</div>

				<div class="comment-form-fields">
				<input name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="" type="hidden">
				<input name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="" type="hidden">
				<input name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="" type="hidden">
				<p class="comment-form-posting-as pa-facebook"><strong></strong> You are commenting using your Facebook account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout(%20'facebook'%20);">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-googleplus" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/ad516503a11cd5ca435acc9bb6523536.png" alt="Google+ photo" class="no-grav" width="25">
			</div>

				<div class="comment-form-fields">
				<input name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value="" type="hidden">
				<input name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value="" type="hidden">
				<input name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value="" type="hidden">
				<p class="comment-form-posting-as pa-googleplus"><strong></strong> You are commenting using your Google+ account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout(%20'googleplus'%20);">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>

</div>

<script type="text/javascript">
var highlander_expando_javascript = function(){
	var input = document.createElement( 'input' ),
	    comment = jQuery( '#comment' );

	if ( 'placeholder' in input ) {
		comment.attr( 'placeholder', jQuery( '.comment-textarea label' ).remove().text() );
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	jQuery( '#comment-form-identity' ).hide();
	jQuery( '#comment-form-subscribe' ).hide();
	jQuery( '#commentform .form-submit' ).hide();

	comment.css( { 'height':'10px' } ).one( 'focus', function() {
		var timer = setInterval( HighlanderComments.resizeCallback, 10 )
		jQuery( this ).animate( { 'height': HighlanderComments.initialHeight } ).delay( 100 ).queue( function(n) { clearInterval( timer ); HighlanderComments.resizeCallback(); n(); } );
		jQuery( '#comment-form-identity' ).slideDown();
		jQuery( '#comment-form-subscribe' ).slideDown();
		jQuery( '#commentform .form-submit' ).slideDown();
	});
}
jQuery(document).ready( highlander_expando_javascript );
</script>

<div style="display: none;" id="comment-form-subscribe">
	<p class="comment-subscription-form"><input name="subscribe" id="subscribe" value="subscribe" style="width: auto;" type="checkbox"> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of new comments via email.</label></p></div>




<p style="display: none;" class="form-submit"><input name="submit" id="comment-submit" class="submit" value="Post Comment" type="submit"> <input name="comment_post_ID" value="3998" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="a405e4b262" type="hidden"></p>
<input name="genseq" value="1474420757" type="hidden">
<p style="display: none;"></p>				<input id="ak_js" name="ak_js" value="1474420766585" type="hidden"></form>
					</div><!-- #respond -->
		<div style="clear: both"></div>
</div><!-- #comments .comments-area -->

			
			</div><!-- #content .site-content -->
		</div><!-- #primary .content-area -->

		<div id="secondary" class="widget-area" role="complementary">
						<aside id="blog_subscription-3" class="widget widget_blog_subscription"><h1 class="widget-title"><label for="subscribe-field">Follow via Email</label></h1>
				<form action="https://subscribe.wordpress.com" method="post" accept-charset="utf-8" id="subscribe-blog">
											<p>Enter your email address to follow this blog and receive notifications of new posts by email.</p>
<p>Join 2,009 other followers</p>
						<p><input name="email" style="width: 95%; padding: 1px 2px" placeholder="Enter your email address" id="subscribe-field" type="text"></p>
					
					<p>
						<input name="action" value="subscribe" type="hidden">
						<input name="blog_id" value="53579024" type="hidden">
						<input name="source" value="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/" type="hidden">
						<input name="sub-type" value="widget" type="hidden">
						<input name="redirect_fragment" value="blog_subscription-3" type="hidden">
						<input id="_wpnonce" name="_wpnonce" value="e2eb7996e4" type="hidden">						<input value="Follow" type="submit">
					</p>
				</form>
			
</aside><aside id="text-3" class="widget widget_text"><h1 class="widget-title">About</h1>			<div class="textwidget"><p>I'm a developer at Automattic where I work on growth and analytics for WordPress.com. I also built <a href="http://www.leandomainsearch.com/">Lean Domain Search</a>, <a href="http://www.preceden.com/">Preceden</a> and a number of other software products over the years.</p>
<p>I love solving problems and helping others do the same. Drop me a note if I can help with anything.</p>
</div>
		</aside><aside id="text-2" class="widget widget_text">			<div class="textwidget"><p></p>
<a href="mailto:matthew.h.mazur@gmail.com" title="GMail"><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/gmail.png"></a>

<a href="http://twitter.com/mhmazur" title="Twitter"><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/twitter.png"></a>

<a href="http://www.linkedin.com/in/mhmazur" title="LinkedIn"><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/linkedin.png"></a>

<a href="https://mattmazur.com/feed/" title="RSS"><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/rss.png"></a>

<a href="http://cloud.feedly.com/#subscription%2Ffeed%2Fhttp%3A%2F%2Fmattmazur.com%2Ffeed%2F" title="Feedly"><img src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/feedly1.png"></a></div>
		</aside><aside id="search-3" class="widget widget_search">	<form method="get" id="searchform" action="https://mattmazur.com/" role="search">
		<label for="s" class="assistive-text">Search</label>
		<input class="field" name="s" id="s" placeholder="Search …" type="text">
		<input class="submit" name="submit" id="searchsubmit" value="Search" type="submit">
	</form>
</aside><aside id="twitter_timeline-2" class="widget widget_twitter_timeline"><h1 class="widget-title">Follow me on Twitter</h1><iframe title="Twitter Timeline" data-widget-id="545611726235123712" style="position: static; visibility: visible; display: inline-block; width: 225px; height: 1617px; padding: 0px; border: medium none; max-width: 100%; min-width: 180px; margin-top: 0px; margin-bottom: 0px;" class="twitter-timeline twitter-timeline-rendered" allowfullscreen="true" allowtransparency="true" scrolling="no" id="twitter-widget-0" frameborder="0"></iframe></aside>		</div><!-- #secondary .widget-area -->

	</div><!-- #main .site-main -->

	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="site-info">
			<a href="https://wordpress.com/?ref=footer_blog">Blog at WordPress.com.</a> 		</div><!-- .site-info -->
	</footer><!-- #colophon .site-footer -->
</div><!-- #page .hfeed .site -->

<!-- wpcom_wp_footer -->
		<script type="text/javascript">
			!function(d,s,id){
				var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';
				if(!d.getElementById(id)){
					js=d.createElement(s);
					js.id=id;js.src=p+"://platform.twitter.com/widgets.js";
					fjs.parentNode.insertBefore(js,fjs);
				}
			}(document,"script","twitter-wjs");
		</script>
		<script type="text/javascript" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/gprofiles.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type="text/javascript" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/wpgroho.js"></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {

			if (typeof Gravatar === "undefined"){
				return;
			}

			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-fe7abe552d96bab4d98bccce357000eb">
	</div>
	<div class="grofile-hash-map-aa9e67eb9772038419f79dea484681b7">
	</div>
	<div class="grofile-hash-map-61e4ab627bc6527062c35acc03db0e08">
	</div>
	<div class="grofile-hash-map-2a248780c935d35caf8f9bb0108393c6">
	</div>
	<div class="grofile-hash-map-387636b50647d7bdcea576d840a15592">
	</div>
	<div class="grofile-hash-map-4f2dc6d2646f91673908ef2ab379807d">
	</div>
	<div class="grofile-hash-map-36410bc698c05fe9cc30bca18d8e96ed">
	</div>
	<div class="grofile-hash-map-82d561dcb070b01aa3c94031315df2e1">
	</div>
	<div class="grofile-hash-map-14a5bbd95ed0c34b3bb11de5028d51f4">
	</div>
	<div class="grofile-hash-map-c1408838096c4eea77efe7b45ce038f8">
	</div>
	<div class="grofile-hash-map-e4ab10dc291c2e019f6dd283df747fef">
	</div>
	<div class="grofile-hash-map-a8984bc12b76444448bc40fd87daa194">
	</div>
	<div class="grofile-hash-map-55f28e9c77b35b1539af6be60986b0e4">
	</div>
	<div class="grofile-hash-map-097eeada97f29ce29a3a6ea79db39de0">
	</div>
	<div class="grofile-hash-map-6160e41069e535b55caa8d7c6d41bb91">
	</div>
	<div class="grofile-hash-map-60bdf35130b230f95567560265ed7bfe">
	</div>
	<div class="grofile-hash-map-87fff166977c518f4a21ec46a787e947">
	</div>
	<div class="grofile-hash-map-967d3a81b0cad6ebbff601f9ce9cf23b">
	</div>
	<div class="grofile-hash-map-05576b294d1bbd0345a48c2a884d465a">
	</div>
	<div class="grofile-hash-map-062d40380f36be661511bedca6e3f0bb">
	</div>
	</div>
<script type="text/javascript">
/* <![CDATA[ */
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"https:\/\/matthewmazur.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/matthewmazur.wordpress.com\/wp-login.php?action=logout&_wpnonce=7a9adbb8d3","homeURL":"https:\/\/mattmazur.com\/","postID":"3998","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"","userIsLoggedIn":"","isJetpack":"0","text_direction":"ltr"};
/* ]]> */
</script>
<script type="text/javascript" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/a_003"></script>

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/mattmazur.com\/2015\/03\/17\/a-step-by-step-backpropagation-example\/":3998};
	</script>
		<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
		<script type="text/javascript" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/form.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var actionbardata = {"siteID":"53579024","siteName":"Matt Mazur","siteURL":"https:\/\/mattmazur.com","icon":"<img alt='' src='https:\/\/s1.wp.com\/i\/void.gif' class='avatar avatar-36' height='36' width='36' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/publish","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/matthewmazur.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fmattmazur.com%2F2015%2F03%2F17%2Fa-step-by-step-backpropagation-example%2F","themeURL":"https:\/\/wordpress.com\/themes\/publish\/","xhrURL":"https:\/\/mattmazur.com\/wp-admin\/admin-ajax.php","nonce":"6f1e404218","isSingular":"1","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"e2eb7996e4\" \/><input type=\"hidden\" name=\"_wp_http_referer\" value=\"\/2015\/03\/17\/a-step-by-step-backpropagation-example\/\" \/>","referer":"https:\/\/mattmazur.com\/2015\/03\/17\/a-step-by-step-backpropagation-example\/","canFollow":"1","statusMessage":"","customizeLink":"https:\/\/matthewmazur.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fmatthewmazur.wordpress.com%2F2015%2F03%2F17%2Fa-step-by-step-backpropagation-example%2F","postID":"3998","shortlink":"http:\/\/wp.me\/p3COlO-12u","canEditPost":"","editLink":"https:\/\/wordpress.com\/post\/mattmazur.com\/3998","i18n":{"view":"View Site","follow":"Follow","following":"Following","edit":"Edit","login":"Log In","signup":"Sign Up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: Publish","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editFollows":"Manage Sites I Follow","editSubs":"Manage Subscriptions","viewReader":"View Site in the Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"Join 2,009 other followers","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/matthewmazur.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fmattmazur.com%2F2015%2F03%2F17%2Fa-step-by-step-backpropagation-example%2F\">Log in now.<\/a>"}};
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/a"></script><div class="actnbr-pub-publish actnbr-has-follow" id="actionbar"><ul><li class="actnbr-btn actnbr-hidden"> 			    	<a class="actnbr-action actnbr-actn-follow" href=""><svg class="gridicon gridicon__follow" height="24px" width="24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 16v2h-3v3h-2v-3h-3v-2h3v-3h2v3h3zM20 2v9h-4v3h-3v4H4c-1.1 0-2-.9-2-2V2h18zM8 13v-1H4v1h4zm3-3H4v1h7v-1zm0-2H4v1h7V8zm7-4H4v2h14V4z"></path></g></svg><span>Follow</span></a> 			    	<div class="actnbr-popover tip tip-top-left actnbr-notice"> 			    		<div class="tip-arrow"></div> 			    		<div class="tip-inner actnbr-follow-bubble"></div> 			    	</div> 			    </li><li class="actnbr-ellipsis actnbr-hidden"> 			  <svg class="gridicon gridicon__ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><circle cx="5" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="12" cy="12" r="2"></circle></g></svg> 			  <div class="actnbr-popover tip tip-top-left actnbr-more"> 			  	<div class="tip-arrow"></div> 			  	<div class="tip-inner"> 				  <ul> 				    <li class="actnbr-sitename actnbr-hidden"><a href="https://mattmazur.com/"><img alt="" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/void.gif" class="avatar avatar-36" height="36" width="36"> Matt Mazur</a></li> 				   	<li class="actnbr-folded-customize actnbr-hidden"><a href="https://matthewmazur.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Fmatthewmazur.wordpress.com%2F2015%2F03%2F17%2Fa-step-by-step-backpropagation-example%2F"><svg class="gridicon gridicon__customize" height="20px" width="20px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M2 6c0-1.505.78-3.08 2-4 0 .845.69 2 2 2 1.657 0 3 1.343 3 3 0 .386-.08.752-.212 1.09.74.594 1.476 1.19 2.19 1.81L8.9 11.98c-.62-.716-1.214-1.454-1.807-2.192C6.753 9.92 6.387 10 6 10c-2.21 0-4-1.79-4-4zm12.152 6.848l1.34-1.34c.607.304 1.283.492 2.008.492 2.485 0 4.5-2.015 4.5-4.5 0-.725-.188-1.4-.493-2.007L18 9l-2-2 3.507-3.507C18.9 3.188 18.225 3 17.5 3 15.015 3 13 5.015 13 7.5c0 .725.188 1.4.493 2.007L3 20l2 2 6.848-6.848c1.885 1.928 3.874 3.753 5.977 5.45l1.425 1.148 1.5-1.5-1.15-1.425c-1.695-2.103-3.52-4.092-5.448-5.977z" data-reactid=".2.1.1:0.1b.0"></path></g></svg><span>Customize<span></span></span></a></li> 				    <li class="actnbr-folded-follow actnbr-hidden"><a class="actnbr-action actnbr-actn-follow" href=""><svg class="gridicon gridicon__follow" height="24px" width="24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 16v2h-3v3h-2v-3h-3v-2h3v-3h2v3h3zM20 2v9h-4v3h-3v4H4c-1.1 0-2-.9-2-2V2h18zM8 13v-1H4v1h4zm3-3H4v1h7v-1zm0-2H4v1h7V8zm7-4H4v2h14V4z"></path></g></svg><span>Follow</span></a></li> 						<li class="actnbr-signup actnbr-hidden"><a href="https://wordpress.com/start/">Sign Up</a></li> 				    <li class="actnbr-login actnbr-hidden"><a href="https://matthewmazur.wordpress.com/wp-login.php?redirect_to=https%3A%2F%2Fmattmazur.com%2F2015%2F03%2F17%2Fa-step-by-step-backpropagation-example%2F">Log In</a></li> 				     				    <li class="actnbr-shortlink actnbr-hidden"><a href="http://wp.me/p3COlO-12u">Copy shortlink</a></li> 				     				     				     				    <li class="actnbr-subs actnbr-hidden"><a href="https://subscribe.wordpress.com/">Manage Subscriptions</a></li> 				    <li class="actnbr-fold actnbr-hidden"><a href="">Collapse this bar</a></li> 			      </ul> 			    </div> 		      </div> 		    </li> 	      </ul></div>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>		<iframe src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/master.html" scrolling="no" id="likes-master" name="likes-master" style="display:none;"></iframe>
		<div id="likes-other-gravatars"><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
		<script>
			var _comscore = _comscore || [];
			_comscore.push({
				c1: "2",
				c2: "7518284"
			});
			(function() {
				var s = document.createElement("script"),
					el = document.getElementsByTagName("script")[0];
				s.async = true;
				s.src = (document.location.protocol == "https:" ? "https://sb" : "http://b") + ".scorecardresearch.com/beacon.js";
				el.parentNode.insertBefore(s, el);
			})();
		</script>
		<noscript>
			<p class="robots-nocontent"><img src="https://sb.scorecardresearch.com/p?c1=2&c2=7518284&c3=&c4=&c5=&c6=&c15=&cv=2.0&cj=1" alt="" style="display:none;" width="1" height="1" /></p>
		</noscript><script src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/w.js" type="text/javascript" async="" defer="defer"></script>
<script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'53579024','blog_tz':'-4','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'53579024','v':'wpcom','tz':'-4','user_id':'0','post':'3998','subd':'matthewmazur'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1TaVhzUzFMbjdWNHpwZGhTayxPSUFCMGRVYVNrSFguN3FwSmQ5RGtNX3VQcj1yVzhiflM1THQtLGFdQ2toOXYlK0JfZ0Y2Zk1mRUQtVkxkeWZBTzRYWlo9S2RoaEJXaEJZT1lRVGRncmFPdi5zQj1fVm5xWjBVJnBnQiwzQVVhUkNjfExlPzNIMDY1NkxNUEovZUhnUyZ4SGF6S2l6TGVUU3FQMHNDJjJtVGxyRWxML0R1XVJIRkgvdDF0QmFdalN2UWhqUS9zZGlUcl9MV1p5SkNfdjEwbDUmcXU5cn5LQlpRbFZlfnl6MStWWTVScWtiNHJYbyY4T0R1cHJJbVhCNDB6Y1ErQSVfcDFob18vR3ctLmIvbD1TZn5WcktXb345QiV5PQ=='}]);
_stq.push([ 'clickTrackerInit', '53579024', '3998' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>

<iframe style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: medium none;" allowfullscreen="true" allowtransparency="true" scrolling="no" id="rufous-sandbox" frameborder="0"></iframe><img id="wpstats" alt=":)" src="A%20Step%20by%20Step%20Backpropagation%20Example%20%E2%80%93%20Matt%20Mazur_files/g.gif"></body></html>